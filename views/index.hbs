<!DOCTYPE html>
<html>

<head>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
  <link rel="stylesheet" href="/css/styles.css">
</head>

<body>
<nav class="main-nav">
  <div class="nav-container">
    <a href="/products" class="brand">StoreAdmin</a>
    <ul>
      <li><a href="/products">Dashboard</a></li>
      <li>
        <form action="/api/logout" method="POST" class="inline-form">
          <button type="submit" class="logout-link">Logout</button>
        </form>
      </li>
    </ul>
  </div>
</nav>
<div class="content-wrapper">
  <h1>Products</h1>

  <table border="1" cellpadding="8" cellspacing="0" style="border-collapse: collapse;">
    <thead>
      <tr>
        <th>ID</th>
        <th>Name</th>
        <th>Price</th>
        <th><button id="create-btn" popovertarget="create-modal">Add</button></th>
      </tr>
    </thead>
    <tbody>
      {{#each products}}
      <tr>
        <td>{{id}}</td>
        <td>{{name}}</td>
        <td>${{price}}</td>
        <td>
          <button class="update-btn" popovertarget="update-modal-{{id}}" data-id="{{id}}" data-name="{{name}}"
            data-price="{{price}}">
            Update
          </button>
        
          <form action="/api/products/delete" method="POST" class="inline-form">
            <input type="hidden" name="_method" value="DELETE">
            <input type="hidden" name="id" value="{{id}}">
            <button type="submit" id="delete-btn"
              onclick="return confirm('Are you sure you want to delete this product?')">
              Delete
            </button>
          </form>
        </td>
      </tr>
       <div id="update-modal-{{id}}" popover>
    <div style="padding: 20px; max-width: 500px;">
      <h3>Update Product</h3>
      <form action='/api/products/update' method="POST" >
        <input type="hidden" name="_method" value="PUT">
        <input type="hidden" id="updateId" name="id" value="{{id}}">

        <div style="margin-bottom: 15px;">
          <label style="display: block; margin-bottom: 5px; font-weight: 600;">Name:</label>
          <input type="text" name="name" id="updateName" value="{{name}}" required
            style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
        </div>

        <div style="margin-bottom: 20px;">
          <label style="display: block; margin-bottom: 5px; font-weight: 600;">Price:</label>
          <input type="number" name="price" id="updatePrice" step="0.01" value="{{price}}" required
            style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
        </div>

        <div style="display: flex; gap: 10px; justify-content: flex-end;">
          <button type="submit"
            style="padding: 10px 20px; background: #FF4B2B; color: white; border: none; border-radius: 4px; cursor: pointer;">
            Save Changes
          </button>
          <button type="button" popovertarget="update-modal" popovertargetaction="hide"
            style="padding: 10px 20px; background: #f0f0f0; border: 1px solid #ddd; border-radius: 4px; cursor: pointer;">
            Cancel
          </button>
        </div>
      </form>
    </div>
 </div>
      {{/each}}
    </tbody>
  </table>

  


    <div id="create-modal" popover>
      <div style="padding: 20px; max-width: 500px;">
        <h3>Create Product</h3>
        <form action="/api/products" method="POST" id="createProductForm">
          <input type="hidden" name="_method" value="POST">

          <div style="margin-bottom: 15px;">
            <label style="display: block; margin-bottom: 5px; font-weight: 600;">Name:</label>
            <input type="text" name="name" id="createName" required
              style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
          </div>

          <div style="margin-bottom: 20px;">
            <label style="display: block; margin-bottom: 5px; font-weight: 600;">Price:</label>
            <input type="number" name="price" id="createPrice" step="0.01" required
              style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
          </div>

          <div style="display: flex; gap: 10px; justify-content: flex-end;">
            <button type="submit"
              style="padding: 10px 20px; background: #FF4B2B; color: white; border: none; border-radius: 4px; cursor: pointer;">
              Create Product
            </button>
            <button type="button" popovertarget="create-modal" popovertargetaction="hide"
              style="padding: 10px 20px; background: #f0f0f0; border: 1px solid #ddd; border-radius: 4px; cursor: pointer;">
              Cancel
            </button>
          </div>
        </form>
      </div>
    </div>
</div>
    
</body>

</html>